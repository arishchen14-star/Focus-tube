<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Focus Tube Premium</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #0f0f0f; color: white; padding: 15px; margin: 0; }
        .container { max-width: 500px; margin: auto; }
        h2 { color: #ff0000; text-align: center; font-size: 28px; text-shadow: 0px 0px 10px rgba(255,0,0,0.3); }
        input { width: 100%; padding: 15px; box-sizing: border-box; border-radius: 10px; border: 1px solid #333; margin-bottom: 10px; background: #1a1a1a; color: white; outline: none; }
        button { width: 100%; padding: 15px; background: #ff0000; color: white; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        button:active { transform: scale(0.95); }
        #video-container { margin-top: 15px; border-radius: 15px; overflow: hidden; background: #000; aspect-ratio: 16/9; display: flex; align-items: center; justify-content: center; border: 1px solid #333; }
        .video-item { background: #1a1a1a; padding: 15px; margin-bottom: 12px; border-radius: 12px; border: 1px solid #333; }
        .item-controls { display: flex; gap: 8px; margin-top: 12px; }
        .item-controls button { padding: 8px; font-size: 13px; margin-bottom: 0; }
        .play-btn { background: #2ecc71; }
        .dl-btn { background: #3498db; }
        .del-btn { background: #333; }
        p { color: #888; text-align: center; font-size: 14px; }
    </style>
</head>
<body>

<div class="container">
    <h2>Focus Tube Pro ðŸŽ¥</h2>
    <input type="text" id="videoLink" placeholder="Paste YouTube link here...">
    <button onclick="saveAndPlay()">Play & Save Now</button>

    <div id="video-container">
        <p id="msg">Video will appear here.<br>Try a different link if Error 153 shows.</p>
    </div>

    <div class="saved-list">
        <h3 style="margin-top: 30px;">Your Library</h3>
        <div id="list"></div>
    </div>
</div>

<script>
    function extractId(url) {
        const regex = /(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/;
        const match = url.match(regex);
        return (match && match[1]) ? match[1] : null;
    }

    function playVideo(id) {
        // 'origin' parameter security errors ko kam karne mein help karta hai
        const embedUrl = `https://www.youtube.com/embed/${id}?rel=0&modestbranding=1&autoplay=1`;
        document.getElementById('video-container').innerHTML = 
            `<iframe width="100%" height="100%" src="${embedUrl}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`;
    }

    function saveAndPlay() {
        let url = document.getElementById('videoLink').value;
        let id = extractId(url);
        if(id) {
            playVideo(id);
            saveToLocal(id);
            document.getElementById('videoLink').value = "";
        } else { alert("Please paste a valid YouTube link!"); }
    }

    function saveToLocal(id) {
        let videos = JSON.parse(localStorage.getItem('focusVideos') || "[]");
        if(!videos.includes(id)) {
            videos.unshift(id); // New videos top par aayengi
            localStorage.setItem('focusVideos', JSON.stringify(videos));
            displayList();
        }
    }

    function deleteVideo(id) {
        let videos = JSON.parse(localStorage.getItem('focusVideos') || "[]");
        videos = videos.filter(v => v !== id);
        localStorage.setItem('focusVideos', JSON.stringify(videos));
        displayList();
    }

    function downloadVideo(id) {
        window.open(`https://en.savefrom.net/1-youtube-video-downloader-4vV/`, '_blank');
        alert("Paste the ID or link in the opened site to download.");
    }

    function displayList() {
        let videos = JSON.parse(localStorage.getItem('focusVideos') || "[]");
        let listHtml = "";
        videos.forEach((id) => {
            listHtml += `
                <div class="video-item">
                    <span style="font-size: 12px; color: #aaa;">ID: ${id}</span>
                    <div class="item-controls">
                        <button class="play-btn" onclick="playVideo('${id}')">Play</button>
                        <button class="dl-btn" onclick="downloadVideo('${id}')">Download</button>
                        <button class="del-btn" onclick="deleteVideo('${id}')">Delete</button>
                    </div>
                </div>`;
        });
        document.getElementById('list').innerHTML = listHtml || "<p>No videos saved.</p>";
    }

    displayList();
</script>

</body>
</html>

<script>
    function downloadVideo(id) {
        // Method 1: Google Search for Downloader (Safest for mobile)
        let dlUrl = "https://www.google.com/search?q=youtube+to+mp4+" + id;
        
        // Method 2: Direct link (Agar block na ho)
        let directDl = "https://y2mate.is/en/youtube/" + id;
        
        window.open(directDl, '_blank');
        alert("Downloading window opened. If it fails, try a different link.");
    }
</script>
