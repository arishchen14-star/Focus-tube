<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Focus Tube Pro</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #000; color: white; padding: 15px; margin: 0; }
        .container { max-width: 500px; margin: auto; text-align: center; }
        h2 { color: #ff0000; letter-spacing: 1px; }
        input { width: 100%; padding: 15px; border-radius: 10px; border: 1px solid #333; margin-bottom: 10px; background: #111; color: white; box-sizing: border-box; outline: none; }
        .main-btn { width: 100%; padding: 15px; background: #ff0000; color: white; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; margin-bottom: 20px; }
        #video-container { border-radius: 15px; overflow: hidden; background: #111; aspect-ratio: 16/9; border: 1px solid #222; box-shadow: 0 4px 15px rgba(255,0,0,0.1); }
        .video-item { background: #111; padding: 15px; margin-top: 15px; border-radius: 12px; border: 1px solid #333; text-align: left; }
        .video-title { font-weight: bold; color: #fff; display: block; margin-bottom: 8px; font-size: 16px; }
        .item-controls { display: flex; gap: 8px; flex-wrap: wrap; }
        .item-controls button { flex: 1; padding: 10px; font-size: 12px; border: none; border-radius: 6px; font-weight: bold; cursor: pointer; color: white; }
        .play-btn { background: #27ae60; }
        .dl-btn { background: #3498db; }
        .rename-btn { background: #f39c12; }
        .del-btn { background: #c0392b; }
    </style>
</head>
<body>

<div class="container">
    <h2>Focus Tube Pro ðŸŽ¥</h2>
    <input type="text" id="videoLink" placeholder="Paste YouTube Link Here...">
    <button class="main-btn" onclick="saveAndPlay()">Play & Save Now</button>

    <div id="video-container">
        <p style="color:#666; padding-top:20%;">Video will load here</p>
    </div>

    <div id="list-container">
        <h3 style="text-align: left; margin-top: 30px;">Your Library</h3>
        <div id="list"></div>
    </div>
</div>

<script>
    function extractId(url) {
        const regex = /(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/;
        const match = url.match(regex);
        return (match && match[1]) ? match[1] : null;
    }

    function playVideo(id) {
        document.getElementById('video-container').innerHTML = 
            `<iframe width="100%" height="100%" src="https://www.youtube.com/embed/${id}?modestbranding=1&rel=0&autoplay=1" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>`;
    }

    function saveAndPlay() {
        let url = document.getElementById('videoLink').value;
        let id = extractId(url);
        if(id) {
            playVideo(id);
            saveToLocal(id);
            document.getElementById('videoLink').value = "";
        } else { alert("Invalid YouTube Link!"); }
    }

    function saveToLocal(id) {
        let videos = JSON.parse(localStorage.getItem('focus-vids-v2') || "[]");
        if(!videos.find(v => v.id === id)) {
            videos.unshift({id: id, name: "New Video " + (videos.length + 1)});
            localStorage.setItem('focus-vids-v2', JSON.stringify(videos));
            displayList();
        }
    }

    function renameVideo(id) {
        let newName = prompt("Enter new name for this video:");
        if(newName) {
            let videos = JSON.parse(localStorage.getItem('focus-vids-v2'));
            let video = videos.find(v => v.id === id);
            if(video) {
                video.name = newName;
                localStorage.setItem('focus-vids-v2', JSON.stringify(videos));
                displayList();
            }
        }
    }

    function deleteVideo(id) {
        if(confirm("Delete this video?")) {
            let videos = JSON.parse(localStorage.getItem('focus-vids-v2')).filter(v => v.id !== id);
            localStorage.setItem('focus-vids-v2', JSON.stringify(videos));
            displayList();
        }
    }

    function downloadVideo(id) {
        // Redirect to SaveFrom.net with the video URL
        let ytUrl = "https://www.youtube.com/watch?v=" + id;
        let dlUrl = "https://en.savefrom.net/1-youtube-video-downloader-13sg/?url=" + encodeURIComponent(ytUrl);
        window.open(dlUrl, '_blank');
    }

    function displayList() {
        let videos = JSON.parse(localStorage.getItem('focus-vids-v2') || "[]");
        let listHtml = "";
        videos.forEach((vid) => {
            listHtml += `
                <div class="video-item">
                    <span class="video-title">${vid.name}</span>
                    <div class="item-controls">
                        <button class="play-btn" onclick="playVideo('${vid.id}')">Play</button>
                        <button class="rename-btn" onclick="renameVideo('${vid.id}')">Rename</button>
                        <button class="dl-btn" onclick="downloadVideo('${vid.id}')">Download</button>
                        <button class="del-btn" onclick="deleteVideo('${vid.id}')">Delete</button>
                    </div>
                </div>`;
        });
        document.getElementById('list').innerHTML = videos.length ? listHtml : "<p style='color:#444'>No videos saved yet.</p>";
    }

    displayList();
</script>

</body>
</html>
